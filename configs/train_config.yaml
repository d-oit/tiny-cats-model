# Training configuration for tiny-cats-model
# Usage: python train.py --config configs/train_config.yaml

# ---------------------------------------------------------------------------
# Data
# ---------------------------------------------------------------------------
data:
  data_dir: data/cats          # Root directory with cat images
  train_split: 0.8             # Fraction of data for training
  val_split: 0.1               # Fraction of data for validation
  test_split: 0.1              # Fraction of data for testing
  num_classes: 2               # Number of output classes (e.g. cat / not-cat)
  class_names:                 # Optional human-readable labels
    - cat
    - not_cat

# ---------------------------------------------------------------------------
# Model
# ---------------------------------------------------------------------------
model:
  backbone: resnet18           # One of: resnet18, mobilenet_v3_small
  pretrained: true             # Load ImageNet weights
  num_classes: 2               # Must match data.num_classes

# ---------------------------------------------------------------------------
# Training hyper-parameters
# ---------------------------------------------------------------------------
training:
  epochs: 30
  batch_size: 32
  num_workers: 4
  pin_memory: true
  seed: 42

# ---------------------------------------------------------------------------
# Optimizer
# ---------------------------------------------------------------------------
optimizer:
  name: adamw                  # One of: adam, adamw, sgd
  lr: 1.0e-3
  weight_decay: 1.0e-4
  momentum: 0.9                # Only used when name=sgd

# ---------------------------------------------------------------------------
# Learning-rate scheduler
# ---------------------------------------------------------------------------
scheduler:
  name: cosine                 # One of: cosine, steplr, null
  T_max: 30                    # For cosine annealing
  eta_min: 1.0e-6              # For cosine annealing
  step_size: 10                # For steplr
  gamma: 0.1                  # For steplr

# ---------------------------------------------------------------------------
# Augmentation
# ---------------------------------------------------------------------------
augmentation:
  train:
    random_horizontal_flip: true
    random_rotation: 15        # Degrees
    color_jitter:
      brightness: 0.2
      contrast: 0.2
      saturation: 0.2
      hue: 0.1
    normalize:
      mean: [0.485, 0.456, 0.406]
      std: [0.229, 0.224, 0.225]
  val:
    normalize:
      mean: [0.485, 0.456, 0.406]
      std: [0.229, 0.224, 0.225]

# ---------------------------------------------------------------------------
# Checkpointing & Logging
# ---------------------------------------------------------------------------
checkpoint:
  save_dir: checkpoints
  save_best: true              # Save model with best validation accuracy
  save_every: 5                # Also save every N epochs
  monitor: val_accuracy        # Metric to monitor: val_accuracy | val_loss
  mode: max                    # max for accuracy, min for loss

logging:
  log_dir: runs
  log_every: 10                # Log every N batches
  use_tensorboard: true

# ---------------------------------------------------------------------------
# Early stopping
# ---------------------------------------------------------------------------
early_stopping:
  enabled: true
  patience: 7                  # Stop after N epochs without improvement
  min_delta: 1.0e-4
